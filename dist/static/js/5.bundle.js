(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{23:function(e,t,s){},32:function(e,t,s){"use strict";var n=s(23);s.n(n).a},42:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"min-w:full sm:min-w:sm"},[e.error?s("alert",{attrs:{color:"red"}},[e._v(e._s(e.error))]):e._e(),e._v(" "),s("div",[s("div",{staticClass:"text:white text:3/2"},[e._v("\n      Trakt\n      "),this.settings.accessToken&&this.settings.refreshToken?s("span",{staticClass:"inline-block rounded:full bg:green ml:1/4 p:1/3 align:middle"}):s("span",{staticClass:"inline-block rounded:full bg:red ml:1/4 p:1/3 align:middle"})]),e._v(" "),s("div",{staticClass:"text:grey-dark"},[e._v("Used to build the calendar.")]),e._v(" "),s("div",{staticClass:"flex flex:wrap justify:center mt:1"},[s("btn",{on:{click:function(t){e.generateDeviceTokenShow=!0}}},[e._v("Generate an access code")])],1)]),e._v(" "),e.generateDeviceTokenShow?s("generate-device-token",{on:{request:e.onRequest,close:function(t){e.generateDeviceTokenShow=!1}}}):e._e(),e._v(" "),e.checkDeviceTokenShow?s("check-device-token",{attrs:{request:e.request},on:{token:e.onToken,close:function(t){e.checkDeviceTokenShow=!1}}}):e._e()],1)};n._withStripped=!0;var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("modal",{attrs:{show:!0},scopedSlots:e._u([{key:"content",fn:function(){return[s("div",{staticClass:"p:1"},[s("div",{staticClass:"text:3/2 text:center"},[e._v("Authentification code")]),e._v(" "),e.error?s("alert",{attrs:{color:"red"}},[e._v(e._s(e.error))]):e._e(),e._v(" "),e.results?s("div",[s("div",{staticClass:"px:1 text:2 text:bold text:center"},[e._v(e._s(e.results.user_code))]),e._v(" "),s("div",{staticClass:"text:center"},[e._v("\n          1. Enter your code here :\n          "),s("a",{staticClass:"text:white",attrs:{href:e.results.verification_url,target:"_blank"}},[e._v("Verification")])]),e._v(" "),s("div",{staticClass:"text:center"},[e._v('2. Click "It\'s done"')]),e._v(" "),s("div",{staticClass:"flex flex:wrap justify:end items:baseline mt:2"},[s("a",{staticClass:"cursor:pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("Cancel")]),e._v(" "),s("btn",{staticClass:"ml:1",on:{click:function(t){return e.$emit("request",e.results)}}},[e._v("It's done")])],1)]):e._e()],1)]},proxy:!0}])})};i._withStripped=!0;var r={computed:{message:function(){return this.$store.getters["webSocket/message"]}},data:function(){return{error:null,results:null}},created:function(){this.getDeviceCode()},watch:{message:function(e){if("trakt"===e.object)switch(this.error=null,e.method){case"getDeviceCode":e.error?this.error=e.error:this.results=Object.assign({},e.results)}}},methods:{getDeviceCode:function(){this.$store.commit("webSocket/send",{object:"trakt",method:"getDeviceCode"})}}},o=s(1),c=Object(o.a)(r,i,[],!1,null,null,null);c.options.__file="src/frontend/components/settings/GenerateDeviceToken.vue";var a=c.exports,l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("modal",{attrs:{show:!0},scopedSlots:e._u([{key:"content",fn:function(){return[s("div",{staticClass:"p:1"},[s("div",{staticClass:"text:3/2 text:center"},[e._v("Check token")]),e._v(" "),e.error?s("alert",{attrs:{color:"red"}},[e._v(e._s(e.error))]):e._e(),e._v(" "),s("loading",{staticClass:"mt:1",attrs:{"is-loading":e.isLoading}}),e._v(" "),s("div",{staticClass:"flex flex:wrap justify:end items:baseline mt:2"},[s("a",{staticClass:"cursor:pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("Cancel")]),e._v(" "),s("btn",{staticClass:"ml:1",on:{click:function(t){return e.check()}}},[e._v("Retry")])],1)],1)]},proxy:!0}])})};l._withStripped=!0;var u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.isLoading?s("div",{staticClass:"relative block m:auto ripple"},[s("div",{staticClass:"absolute opacity:100 rounded:full border"}),e._v(" "),s("div",{staticClass:"absolute opacity:100 rounded:full border"})]):e._e(),e._v(" "),e.message?s("div",{staticClass:"text:center"},[e._v(e._s(e.message))]):e._e()])};u._withStripped=!0;var d={props:{isLoading:{type:Boolean,default:!1},message:{type:String}}},h=(s(32),Object(o.a)(d,u,[],!1,null,"78dbb4f7",null));h.options.__file="src/frontend/components/Loading.vue";var v={computed:{message:function(){return this.$store.getters["webSocket/message"]}},components:{Loading:h.exports},props:{request:{type:Object,required:!0}},data:function(){return{error:null,timer:null,isLoading:!1}},created:function(){this.check()},methods:{check:function(){var e=this;this.isLoading=!0,this.timer=setInterval((function(){e.$store.commit("webSocket/send",{object:"trakt",method:"checkDeviceAuthorization",params:{code:e.request.device_code}})}),1e3*this.request.interval),setTimeout((function(){clearInterval(e.timer),e.isLoading=!1}),1e3*this.request.expires_in)}},watch:{message:function(e){if("trakt"===e.object)switch(this.error=null,e.method){case"checkDeviceAuthorization":this.isLoading=!1,e.error?this.error=e.error:(clearInterval(this.timer),this.$emit("token",e.results))}}}},f=Object(o.a)(v,l,[],!1,null,null,null);f.options.__file="src/frontend/components/settings/CheckDeviceToken.vue";var _={name:"Trakt",computed:{message:function(){return this.$store.getters["webSocket/message"]}},components:{GenerateDeviceToken:a,CheckDeviceToken:f.exports},data:function(){return{error:null,settings:{},generateDeviceTokenShow:!1,checkDeviceTokenShow:!1,request:null}},created:function(){this.getAll()},watch:{message:function(e){if("trakt"===e.object)switch(this.error=null,e.method){case"getAll":case"update":e.error?this.error=e.error:(this.settings=Object.assign({},e.results),this.isValid());break;default:console.log(e.method)}}},methods:{onRequest:function(e){this.generateDeviceTokenShow=!1,this.checkDeviceTokenShow=!0,this.request=e,this.settings.code=e.device_code,this.update()},onToken:function(e){this.checkDeviceTokenShow=!1,this.settings.accessToken=e.access_token,this.settings.refreshToken=e.refresh_token,this.update()},getAll:function(){this.$store.commit("webSocket/send",{object:"trakt",method:"getAll"})},update:function(){this.$store.commit("webSocket/send",{object:"trakt",method:"update",params:this.settings})},isValid:function(){this.$emit("is-valid",this.settings.code&&this.settings.accessToken&&this.settings.refreshToken)}}},k=Object(o.a)(_,n,[],!1,null,null,null);k.options.__file="src/frontend/components/settings/trakt.vue";t.default=k.exports}}]);